{
    "id": "{{service.name}}",
    "cpus": {{service.cpus}},
    "mem": {{service.mem}},
    "instances": 1,
    "container": {
        "type": "DOCKER",
        "docker": {
            "image": "{{resource.assets.container.docker.predator}}",
            "network": "HOST"
        }
    },
    "portDefinitions": [
        {
            "port": 0,
            "protocol": "tcp",
            "name": "predator",
            "labels": {
                "VIP_0": "/predator:80"
            }
        }
    ],
    "labels": {
        "DCOS_SERVICE_NAME": "{{service.name}}",
        "DCOS_SERVICE_PORT_INDEX": "0",
        "DCOS_SERVICE_SCHEME": "http"
    },
    "env": {
        "JOB_PLATFORM": "METRONOME",
        "MY_ADDRESS": "http://predator.marathon.l4lb.thisdcos.directory:80",
        "DATABASE_TYPE": "{{service.database_type}}",
        "METRONOME_URL": "{{service.metronome_url}}",
        {{#service.database_address}}
            "DATABASE_ADDRESS": "{{service.database_address}}",
        {{/service.database_address}}
        {{#service.database_username}}
            "DATABASE_USERNAME": "{{service.database_username}}",
        {{/service.database_username}}
        {{#service.database_password}}
            "DATABASE_PASSWORD": "{{service.database_password}}",
        {{/service.database_password}}
        {{#service.database_name}}
            "DATABASE_NAME": "{{service.database_name}}",
        {{/service.database_name}}
        {{#service.runner_docker_name}}
            "DOCKER_NAME": "{{service.runner_docker_name}}"
        {{/service.runner_docker_name}}
    },
    "healthChecks": [
        {
            "gracePeriodSeconds": 5,
            "intervalSeconds": 60,
            "timeoutSeconds": 10,
            "maxConsecutiveFailures": 3,
            "portIndex": 0,
            "path": "/health",
            "protocol": "MESOS_HTTP",
            "delaySeconds": 15
        }
    ]
}
